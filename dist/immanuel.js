!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Immanuel=t()}(this,(function(){"use strict";function e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function t(t){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?e(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==a)return;var n,r,s=[],i=!0,l=!1;try{for(a=a.call(e);!(i=(n=a.next()).done)&&(s.push(n.value),!t||s.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{i||null==a.return||a.return()}finally{if(l)throw r}}return s}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return c(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function u(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=o(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,l=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return i=e.done,e},e:function(e){l=!0,s=e},f:function(){try{i||null==a.return||a.return()}finally{if(l)throw s}}}}var h=function(){function e(){a(this,e)}return r(e,null,[{key:"create",value:function(e){return t(t({},this.defaults),e)}}]),e}();s(h,"defaults",{maxOrb:{sun:15,moon:12,mercury:7,venus:7,mars:8,jupiter:9,saturn:9,uranus:5,neptune:5,pluto:5,chiron:5},rotateChart:"horizon",rotateSigns:!0,rotateHouseNumbers:!1,rotateAngleText:!1,angleFormat:"%D&deg;%M'",planetAngleAttribute:null,lineOrder:["houses","angleMarkers","anglePointers","aspects"],aspectOrder:["trine","sextile","semisextile","square","semisquare","sesquisquare","opposite","quintile","semiquintile","sesquiquintile","biquintile","quincunx"]});var f=function(){function e(t){if(a(this,e),this.chart=document.querySelector(t),!this.chart)return!1;this.chartSvgContainer=this.chart.querySelector("[data-immanuel-lines]"),this.chartBackground=this.chart.querySelector("[data-immanuel-background]"),this.signTrack=this.chart.querySelector('[data-immanuel-track="signs"]'),this.signs=this.chart.querySelectorAll("[data-immanuel-sign]"),this.aspectEndBoundary=this.chart.querySelector('[data-immanuel-boundary="aspect-end"]'),this.placeholders={primary:this.chart.querySelectorAll("[data-immanuel-placeholder]"),secondary:this.chart.querySelectorAll("[data-immanuel-secondary-placeholder]"),transits:this.chart.querySelectorAll("[data-immanuel-transit-placeholder]")},this.angleTracks={primary:this.chart.querySelector('[data-immanuel-track="angles"]'),secondary:this.chart.querySelector('[data-immanuel-track="secondary-angles"]'),transits:this.chart.querySelector('[data-immanuel-track="transit-angles"]')},this.angleTextTracks={primary:this.chart.querySelector('[data-immanuel-track="angle-text"]'),secondary:this.chart.querySelector('[data-immanuel-track="secondary-angle-text"]'),transits:this.chart.querySelector('[data-immanuel-track="transit-angle-text"]')},this.planetTracks={primary:this.chart.querySelector('[data-immanuel-track="planets"]'),secondary:this.chart.querySelector('[data-immanuel-track="secondary-planets"]'),transits:this.chart.querySelector('[data-immanuel-track="transit-planets"]')},this.houseNumberTracks={primary:this.chart.querySelector('[data-immanuel-track="house-numbers"]'),secondary:this.chart.querySelector('[data-immanuel-track="secondary-house-numbers"]'),transits:this.chart.querySelector('[data-immanuel-track="transit-house-numbers"]')},this.houseStartBoundaries={primary:this.chart.querySelector('[data-immanuel-boundary="house-start"]'),secondary:this.chart.querySelector('[data-immanuel-boundary="secondary-house-start"]'),transits:this.chart.querySelector('[data-immanuel-boundary="transit-house-start"]')},this.houseEndBoundaries={primary:this.chart.querySelector('[data-immanuel-boundary="house-end"]'),secondary:this.chart.querySelector('[data-immanuel-boundary="secondary-house-end"]'),transits:this.chart.querySelector('[data-immanuel-boundary="transit-house-end"]')},this.angleMarkersStartBoundaries={primary:this.chart.querySelector('[data-immanuel-boundary="angle-markers-start"]'),secondary:this.chart.querySelector('[data-immanuel-boundary="secondary-angle-markers-start"]'),transits:this.chart.querySelector('[data-immanuel-boundary="transit-angle-markers-start"]')},this.angleMarkersEndBoundaries={primary:this.chart.querySelector('[data-immanuel-boundary="angle-markers-end"]'),secondary:this.chart.querySelector('[data-immanuel-boundary="secondary-angle-markers-end"]'),transits:this.chart.querySelector('[data-immanuel-boundary="transit-angle-markers-end"]')},this.angles={primary:this.angleTracks.primary.querySelectorAll("[data-immanuel-angle]"),secondary:this.angleTracks.secondary?this.angleTracks.secondary.querySelectorAll("[data-immanuel-angle]"):null,transits:this.angleTracks.transits?this.angleTracks.transits.querySelectorAll("[data-immanuel-angle]"):null},this.planets={primary:this.planetTracks.primary.querySelectorAll("[data-immanuel-planet]"),secondary:this.planetTracks.secondary?this.planetTracks.secondary.querySelectorAll("[data-immanuel-planet]"):null,transits:this.planetTracks.transits?this.planetTracks.transits.querySelectorAll("[data-immanuel-planet]"):null},this.chartLines=[],this.houseNumbers={},this.angleText={},this.createHouseNumberElements(),this.createAngleTextElements(),this.createSvgElement()}return r(e,[{key:"createSvgElement",value:function(){this.chartSvg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.chartSvg.setAttributeNS(null,"width","100%"),this.chartSvg.setAttributeNS(null,"height","100%"),Object.assign(this.chartSvg.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),this.chartSvgContainer?this.chartSvgContainer.appendChild(this.chartSvg):this.chart.appendChild(this.chartSvg)}},{key:"createHouseNumberElements",value:function(){for(var e=0,t=Object.entries(this.houseNumberTracks);e<t.length;e++){var a=i(t[e],2),n=a[0];if(a[1]){this.houseNumbers[n]=[];for(var r=1;r<=12;++r){var s=document.createElement("span");s.textContent=r,s.style.position="absolute",s.classList.add("immanuel__".concat(n,"-house-number"),"house-number--".concat(r)),this.houseNumbers[n][r]=s,this.houseNumberTracks[n].appendChild(s)}}}}},{key:"createAngleTextElements",value:function(){for(var e=this,t=function(){var t=i(n[a],2),r=t[0],s=t[1];s&&(e.angleText[r]={},e.planets[r].forEach((function(t){var a=t.getAttribute("data-immanuel-planet"),n=a.replace(" ","-"),i=document.createElement("div");i.classList.add("immanuel__".concat(r,"-angle-text"),"angle-text--".concat(n)),i.style.position="absolute",e.angleText[r][a]=i,s.appendChild(i)})))},a=0,n=Object.entries(this.angleTextTracks);a<n.length;a++)t()}}],[{key:"create",value:function(e){return this.instance||(this.instance=new this(e))}}]),e}();s(f,"instance",null);var d=function(){function e(){a(this,e)}return r(e,null,[{key:"findRelativePoint",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e.offsetWidth+a,r=n/2,s=t*(Math.PI/180)*-1,i=r+r*Math.cos(s),l=r+r*Math.sin(s);return[i,l]}},{key:"findGlobalPoint",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.findRelativePoint(t,a,n),s=i(r,2),l=s[0],o=s[1],c=t.offsetWidth+n,u=l+(e.offsetWidth-c)/2,h=o+(e.offsetHeight-c)/2;return[u,h]}},{key:"formatAngleString",value:function(e,t){var a={"%D":e.degrees,"%M":e.minutes,"%S":e.seconds};return t.replace(/%D|%M|%S/g,(function(e){return a[e]}))}}]),e}(),m=function(){function e(t,n,r){a(this,e),this.elements=t,this.options=n,this.chartData=r.primary?r:{primary:r},this.chartTypes=Object.keys(this.chartData),this.offsetAngle=0,this.planets={},this.aspectedPlanets={},this.init()}return r(e,[{key:"init",value:function(){var e,t=this,a=u(this.chartTypes);try{var n=function(){var a=e.value;t.planets[a]={},t.aspectedPlanets[a]=[],t.elements.planets[a].forEach((function(e){var n=e.getAttribute("data-immanuel-planet");if(n in t.chartData.primary.points)var r=t.chartData[a].points[n];else if(n in t.chartData.primary.planets)r=t.chartData[a].planets[n];t.planets[a][n]=r,e.hasAttribute("data-immanuel-no-aspects")||t.aspectedPlanets[a].push(n)}))};for(a.s();!(e=a.n()).done;)n()}catch(e){a.e(e)}finally{a.f()}window.addEventListener("resize",(function(){document.querySelectorAll("[data-immanuel-hide]").length||t.setupChart()}))}},{key:"display",value:function(){var e=this;"complete"===document.readyState?(this.setOffsetAngle(),this.rotateChart(),this.setPlaceholderData(),this.setupChart(),document.querySelectorAll("[data-immanuel-hide]").forEach((function(e){e.removeAttribute("data-immanuel-hide")}))):window.addEventListener("load",(function(){e.display()}))}},{key:"setOffsetAngle",value:function(){"asc"===this.options.rotateChart?this.offsetAngle=-1*(180-this.chartData.primary.angles.asc.chartAngle):"horizon"===this.options.rotateChart?this.offsetAngle=-1*(180-this.chartData.primary.houses[1].chartAngle):this.offsetAngle=0}},{key:"rotateChart",value:function(){this.elements.chartBackground.style.transform=0!==this.offsetAngle?"rotate(".concat(this.offsetAngle,"deg)"):"none"}},{key:"setPlaceholderData",value:function(){var e,t=this,a=u(this.chartTypes);try{var n=function(){var a=e.value;t.elements.placeholders[a]&&t.elements.placeholders[a].forEach((function(e){var n=e.getAttributeNames().find((function(e){return/-placeholder$/.test(e)})),r=e.getAttribute(n);switch(r){case"asc":case"desc":case"mc":case"ic":e.innerHTML=d.formatAngleString(t.chartData[a].angles[r].formattedSignAngle,t.options.angleFormat)}}))};for(a.s();!(e=a.n()).done;)n()}catch(e){a.e(e)}finally{a.f()}}},{key:"setupChart",value:function(){this.elements.signTrack&&this.elements.signs&&this.setSigns(),this.setAngles(),this.setPlanets(),this.removeLines(),this.drawLines()}},{key:"removeLines",value:function(){this.elements.chartLines.forEach((function(e){e.remove()}))}},{key:"drawLines",value:function(){var e=this;this.options.lineOrder.reverse().forEach((function(t){switch(t){case"angleMarkers":e.setPlanetAngleMarkers();break;case"anglePointers":e.setPlanetAnglePointers("primary");break;case"houses":e.setHouses(),e.setHouseNumbers();break;case"aspects":e.setAspects()}}))}},{key:"setAngles",value:function(){var e,t=this,a=u(this.chartTypes);try{var n=function(){var a=e.value;t.elements.angles[a]&&t.elements.angles[a].forEach((function(e){var n=e.getAttribute("data-immanuel-angle"),r=t.chartData[a].angles[n].chartAngle-t.offsetAngle,s=i(d.findRelativePoint(t.elements.angleTracks[a],r),2),l=s[0],o=s[1];l=Math.round(l-e.offsetWidth/2),o=Math.round(o-e.offsetHeight/2),Object.assign(e.style,{position:"absolute",left:l+"px",top:o+"px"})}))};for(a.s();!(e=a.n()).done;)n()}catch(e){a.e(e)}finally{a.f()}}},{key:"setSigns",value:function(){var e=this,t=15-this.offsetAngle;this.elements.signs.forEach((function(a){var n=i(d.findRelativePoint(e.elements.signTrack,t),2),r=n[0],s=n[1];if(r=Math.round(r-a.offsetWidth/2),s=Math.round(s-a.offsetHeight/2),Object.assign(a.style,{position:"absolute",left:r+"px",top:s+"px"}),e.options.rotateSigns){var l=-1*t+90;a.style.transform="rotate(".concat(l,"deg)")}t+=30}))}},{key:"setPlanets",value:function(){this.resetPlanetAngles();var e,t=u(this.chartTypes);try{for(t.s();!(e=t.n()).done;){var a=e.value;this.resolvePlanetCollisions(a)}}catch(e){t.e(e)}finally{t.f()}this.positionPlanets(),this.setPlanetAngleText()}},{key:"resetPlanetAngles",value:function(){var e,t=u(this.chartTypes);try{for(t.s();!(e=t.n()).done;){var a=e.value;Object.values(this.planets[a]).forEach((function(e){e.displayAngle=e.chartAngle}))}}catch(e){t.e(e)}finally{t.f()}}},{key:"resolvePlanetCollisions",value:function(e){var t=this,a=[];this.elements.planets[e].forEach((function(n){var r=n.getAttribute("data-immanuel-planet"),s=t.planets[e][r];t.elements.planets[e].forEach((function(i){var l=i.getAttribute("data-immanuel-planet");if(r!==l){var o=t.planets[e][l],c=Math.max(n.offsetWidth,n.offsetHeight)/2,u=Math.max(i.offsetWidth,i.offsetHeight)/2,h=t.elements.planetTracks[e].offsetWidth,f=Math.abs(s.displayAngle-o.displayAngle);Math.abs(Math.sin(f*(Math.PI/360))*h)<c+u&&(a.forEach((function(e){if(e.includes(s)||e.includes(o))return e.includes(s)||e.push(s),void(e.includes(o)||e.push(o))})),a.push([s,o]))}}))})),a.length>0&&(a.forEach((function(e){e.sort((function(e,t){return Math.abs(e.displayAngle-t.displayAngle)>270?t.displayAngle-e.displayAngle:e.displayAngle-t.displayAngle})),e[0].displayAngle-=.1,e[e.length-1].displayAngle+=.1})),this.resolvePlanetCollisions(e))}},{key:"positionPlanets",value:function(){var e,t=this,a=u(this.chartTypes);try{var n=function(){var a=e.value;t.elements.planets[a].forEach((function(e){var n=e.getAttribute("data-immanuel-planet"),r=t.planets[a][n],s=r.displayAngle-t.offsetAngle,o=r.movement.toLowerCase(),c=l(e.classList),u=c.find((function(e){return/planet-movement--/.test(e)})),h=c.find((function(e){return/planet-sign--/.test(e)}));e.classList.remove(u,h),e.classList.add("immanuel__planet-movement","planet-movement--".concat(o)),e.classList.add("immanuel__planet-sign","planet-sign--".concat(r.sign.toLowerCase())),t.options.planetAngleAttribute&&e.setAttribute(t.options.planetAngleAttribute,d.formatAngleString(r.formattedSignAngle,t.options.angleFormat));var f=i(d.findRelativePoint(t.elements.planetTracks[a],s),2),m=f[0],p=f[1];m=Math.round(m-e.offsetWidth/2),p=Math.round(p-e.offsetHeight/2),Object.assign(e.style,{position:"absolute",left:m+"px",top:p+"px"})}))};for(a.s();!(e=a.n()).done;)n()}catch(e){a.e(e)}finally{a.f()}}},{key:"setPlanetAngleText",value:function(){var e,t=u(this.chartTypes);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(this.elements.angleTextTracks[a])for(var n=0,r=Object.entries(this.planets[a]);n<r.length;n++){var s=i(r[n],2),l=s[0],o=s[1],c=o.displayAngle-this.offsetAngle,h=this.elements.angleText[a][l];if(h.style.transform="none",h.innerHTML=d.formatAngleString(o.formattedSignAngle,this.options.angleFormat),this.options.rotateAngleText){var f=h.offsetWidth/2,m=h.offsetHeight/2,p=-1*c;c>90&&c<270&&(p+=180),h.style.transform="rotate(".concat(p,"deg)")}else{var y=i(d.findRelativePoint(this.elements.chart,c),2),g=y[0],v=y[1];f=h.offsetWidth*(g/this.elements.chart.offsetWidth),m=h.offsetHeight*(v/this.elements.chart.offsetHeight)}var b=i(d.findRelativePoint(this.elements.angleTextTracks[a],c),2),A=b[0],k=b[1];A=Math.round(A-f),k=Math.round(k-m),Object.assign(h.style,{left:A+"px",top:k+"px"})}}}catch(e){t.e(e)}finally{t.f()}}},{key:"setPlanetAngleMarkers",value:function(){var e,t=u(this.chartTypes);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(this.elements.angleMarkersStartBoundaries[a]&&this.elements.angleMarkersEndBoundaries[a])for(var n=0,r=Object.entries(this.planets[a]);n<r.length;n++){var s=i(r[n],2),l=s[0],o=s[1].chartAngle-this.offsetAngle,c=l.replace(" ","-"),h=i(d.findGlobalPoint(this.elements.chart,this.elements.angleMarkersEndBoundaries[a],o),2),f=h[0],m=h[1],p=i(d.findGlobalPoint(this.elements.chart,this.elements.angleMarkersStartBoundaries[a],o),2),y=p[0],g=p[1];this.drawLine(f,m,y,g,"immanuel__".concat(a,"-angle-marker"),"angle-marker--".concat(c))}}}catch(e){t.e(e)}finally{t.f()}}},{key:"setPlanetAnglePointers",value:function(){var e,t=this,a=u(this.chartTypes);try{var n=function(){var a=e.value;t.elements.angleMarkersStartBoundaries[a]&&t.elements.angleMarkersEndBoundaries[a]&&t.elements.planets[a].forEach((function(e){var n=e.getAttribute("data-immanuel-planet"),r=t.planets[a][n],s=r.chartAngle-t.offsetAngle,l=(Math.abs(r.displayAngle-r.chartAngle)<1?r.chartAngle:r.displayAngle)-t.offsetAngle,o=Math.max(e.offsetWidth,e.offsetHeight),c=n.replace(" ","-"),u=t.elements.angleMarkersEndBoundaries[a].offsetWidth-t.elements.angleMarkersStartBoundaries[a].offsetWidth>0?1:-1,h=i(d.findGlobalPoint(t.elements.chart,t.elements.angleMarkersStartBoundaries[a],s),2),f=h[0],m=h[1],p=i(d.findGlobalPoint(t.elements.chart,t.elements.planetTracks[a],l,(o+10)*u),2),y=p[0],g=p[1],v=i(d.findGlobalPoint(t.elements.chart,t.elements.planetTracks[a],l,o*u),2),b=v[0],A=v[1];t.drawLine(f,m,y,g,"immanuel__".concat(a,"-angle-pointer"),"angle-pointer--".concat(c)),t.drawLine(y,g,b,A,"immanuel__".concat(a,"-angle-pointer"),"angle-pointer--".concat(c))}))};for(a.s();!(e=a.n()).done;)n()}catch(e){a.e(e)}finally{a.f()}}},{key:"setHouses",value:function(){var e,t=u(this.chartTypes);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(this.elements.houseStartBoundaries[a]&&this.elements.houseEndBoundaries[a])for(var n=0,r=Object.entries(this.chartData[a].houses);n<r.length;n++){var s=i(r[n],2),l=s[0],o=s[1].chartAngle-this.offsetAngle,c=i(d.findGlobalPoint(this.elements.chart,this.elements.houseEndBoundaries[a],o),2),h=c[0],f=c[1],m=i(d.findGlobalPoint(this.elements.chart,this.elements.houseStartBoundaries[a],o),2),p=m[0],y=m[1];this.drawLine(h,f,p,y,"immanuel__".concat(a,"-house-line"),"house-line--".concat(l))}}}catch(e){t.e(e)}finally{t.f()}}},{key:"setHouseNumbers",value:function(){var e,t=u(this.chartTypes);try{for(t.s();!(e=t.n()).done;){var a=e.value;if(this.elements.houseNumbers[a])for(var n=0,r=Object.entries(this.chartData[a].houses);n<r.length;n++){var s=i(r[n],2),l=s[0],o=s[1].chartAngle-this.offsetAngle,c=12==l?1:parseInt(l)+1,h=this.chartData[a].houses[c].chartAngle,f=o+((h<o?h+360:h)-o-this.offsetAngle)/2,m=this.elements.houseNumbers[a][l],p=i(d.findRelativePoint(this.elements.houseNumberTracks[a],f),2),y=p[0],g=p[1];if(y=Math.round(y-m.offsetWidth/2),g=Math.round(g-m.offsetHeight/2),Object.assign(m.style,{left:y+"px",top:g+"px"}),this.options.rotateHouseNumbers){var v=-1*f+90;m.style.transform="rotate(".concat(v,"deg)")}}}}catch(e){t.e(e)}finally{t.f()}}},{key:"setAspects",value:function(){var e=this,t={};this.options.aspectOrder.reverse().forEach((function(e){return t[e]=[]}));for(var a=0,n=Object.entries(this.planets.primary);a<n.length;a++)for(var r=i(n[a],2),s=r[0],l=r[1],o=function(){var a=i(u[c],2),n=a[0],r=a[1];if(h=e.options.maxOrb instanceof Object&&e.options.maxOrb[n]&&"number"==typeof e.options.maxOrb[n]?e.options.maxOrb[n]:"number"==typeof e.options.maxOrb?e.options.maxOrb:5,r.orb>h)return"continue";var l=r.type.toLowerCase();if(!e.aspectedPlanets.primary.includes(s)||!e.aspectedPlanets[e.chartData.primary.aspectsTo].includes(n)||!e.options.aspectOrder.includes(l))return"continue";var o=[e.planets.primary[s].chartAngle-e.offsetAngle,e.planets[e.chartData.primary.aspectsTo][n].chartAngle-e.offsetAngle].sort();if(t[l].some((function(e){return JSON.stringify(e)===JSON.stringify(o)})))return"continue";t[l].push(o)},c=0,u=Object.entries(l.aspects);c<u.length;c++){var h;o()}for(var f=function(){var t=i(p[m],2),a=t[0];t[1].forEach((function(t){var n=i(t,2),r=n[0],s=n[1],l=i(d.findGlobalPoint(e.elements.chart,e.elements.aspectEndBoundary,r),2),o=l[0],c=l[1],u=i(d.findGlobalPoint(e.elements.chart,e.elements.aspectEndBoundary,s),2),h=u[0],f=u[1];e.drawLine(o,c,h,f,"immanuel__aspect-line","aspect-line--".concat(a))}))},m=0,p=Object.entries(t);m<p.length;m++)f()}},{key:"drawLine",value:function(e,t,a,n){for(var r,s=document.createElementNS("http://www.w3.org/2000/svg","line"),i=arguments.length,l=new Array(i>4?i-4:0),o=4;o<i;o++)l[o-4]=arguments[o];(r=s.classList).add.apply(r,l),s.setAttributeNS(null,"x1",e),s.setAttributeNS(null,"y1",t),s.setAttributeNS(null,"x2",a),s.setAttributeNS(null,"y2",n),this.elements.chartSvg.appendChild(s),this.elements.chartLines.push(s)}}],[{key:"create",value:function(e,t,a){return new this(e,t,a)}}]),e}(),p=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,e),this.elements=f.create(t),this.options=h.create(n)}return r(e,[{key:"setOptions",value:function(e){this.options=t(t({},this.options),e)}},{key:"displayChart",value:function(e){m.create(this.elements,this.options,e).display()}}]),e}();return window.Immanuel=p,p}));
